<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Segmentor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for Segmentor"><tr><td>Segmentor</td><td align="right">R Documentation</td></tr></table>

<h2>Segmentor</h2>

<h3>Description</h3>

<p>
The functions are used for change-point problems. Given a loss function (Poisson, Normal homoscedastic, Negative Binomial or Normal Heteroscedastic (with given constant mean)), the function Segmentor estimates the optimal segmentation with respect to the log-likelihood. The Segmentor gives estimates of the breakpoint locations as well as the loss function parameter of each segment.
</p>


<h3>Usage</h3>

<pre>
Segmentor(data=numeric(), file=character(), model=1, Kmax = 15, param = 0.15)
</pre>


<h3>Arguments</h3>

function(data=numeric(), file=character(), model=1, Kmax = 15, param = 0.15)
<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
A vector of observations to be segmented. Must have no missing values.</td></tr>
<tr valign="top"><td><code>file</code></td>
<td>
Instead of data, the location of a file containing the data to segment. This file must have one numeric value per line and have no missing values. The filename MUST consist of the whole path to the file.</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
Emission distribution of observed data, 1: poisson (default), 2: normal-homoscedastic, 3: negative binomial or 4: normal-heteroscedastic</td></tr>
<tr valign="top"><td><code>Kmax</code></td>
<td>
The maximum number of segments wanted for the data. The Segmentor will find all optimal segmentations in 1 to Kmax segments.</td></tr>
<tr valign="top"><td><code>param</code></td>
<td>
Needed only for the Negative Binomial and the Normal Heteroscedastic distributions: for model 3, the inverse of the overdispersion parameter. By default set to 0.15 as a heuristically good approximate of the parameter for NGS data. For model 4, the mean of the signal. If not entered, the function uses the empirical mean of the data.</td></tr>
</table>


<h3>Details</h3>

<p>

</p>
<table summary="Rd table">
<tr>
 <td align="left">
Package: </td><td align="left"> Segmentor3IsBack</td>
</tr>
<tr>
 <td align="left">
Type: </td><td align="left"> Package</td>
</tr>
<tr>
 <td align="left">
Version: </td><td align="left"> 1.0</td>
</tr>
<tr>
 <td align="left">
Date: </td><td align="left"> 2012-05-10</td>
</tr>
<tr>
 <td align="left">
License: </td><td align="left"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td align="left">
</td>
</tr>

</table><p>

</p>


<h3>Value</h3>

<p>
<table summary="R valueblock">
<tr valign="top"><td><code>model</code></td>
<td>
Emission distribution (Poisson, Normal Homoscedastic, Negative binomial or Normal Heteroscedastic)</td></tr> 
<tr valign="top"><td><code>breaks</code></td>
<td>
Matrix of size Kmax*Kmax of estimated change-point locations for each optimal segmentation in 1 to Kmax segments.</td></tr>
<tr valign="top"><td><code>parameters</code></td>
<td>
Matrix of size Kmax*Kmax which elements are the estimated parameters for each segment of the optimal segmentation. If model is Poisson or Normal, the parameter corresponds to the mean of the signal in each segment. If model is Negative binomial, the parameter corresponds to the success-probability of the signal in each segment. If model is normal heteroscedastic, the parameter is the variance assuming known mean.</td></tr> 
<tr valign="top"><td><code>likelihood</code></td>
<td>
Vector of size Kmax of resulting negative log-likelihood for each optimal segmentation.</td></tr>
</table>
</p>


<h3>Author(s)</h3>

<p>
Alice Cleynen, Michel Koskas and Guillem Rigaill
</p>
<p>
Maintainer: Who to complain to &lt;alice.cleynen@agroparistech.fr&gt;
</p>


<h3>References</h3>

<p>
Pruned dynamic programming for optimal multiple change-point detection: <a href="http://arxiv.org/abs/1004.0887">http://arxiv.org/abs/1004.0887</a>
</p>
<p>
A Generic Implementation of the Pruned Dynamic Programing Algorithm: <a href="http://arxiv.org/abs/1204.5564">http://arxiv.org/abs/1204.5564</a>
</p>


<h3>Examples</h3>

<pre>
require(Segmentor3IsBack);
N=2000; x=c(rpois(N,2.0),rpois(2*N,2.2),rpois(N,1.9));
res=Segmentor(data=x,Kmax=3);  # Finds the optimal segmentation in 1, 2 and 3 segments with respect to the Poisson model

## alternate method, use file containing data 
N=1500; y=c(rnorm(N,0,1),rnorm(2*N,2.2,1),rnorm(N,1.7,1),rnorm(N,0.3,1));
write.table(y,file="mytest.txt",col.names=FALSE, row.names=FALSE)
##res1=Segmentor(file="~/mytest.txt",model=2,Kmax=5); 

</pre>


</body></html>
